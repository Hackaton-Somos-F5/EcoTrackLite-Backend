# HU-B04 · Integración de alertas en el registro

**Como** sistema automático  
**Quiero** que al registrar un residuo se evalúen las alertas automáticamente  
**Para que** el frontend las muestre actualizadas sin necesidad de una llamada extra.

---

## Criterios de Aceptación

- **Extensión de Respuesta:** El endpoint `POST /residuos` debe devolver los datos del residuo creado junto con las alertas activas tras el registro.
- **Campo de Alertas:** La respuesta debe incluir un campo `alertas` que sea una lista vacía `[]` o una lista con los objetos de alerta detectados.
- **No Duplicidad:** La lógica de detección debe invocar exclusivamente a `calcular_alertas()` del módulo de servicios.
- **Sincronización:** El cálculo de alertas debe realizarse **después** del `db.commit()` para asegurar que se evalúen los datos ya persistidos.

---

## Tareas

| Código | Nombre | Estado |
| :--- | :--- | :--- |
| **TK-004-01** | Coordinar con Persona A para modificar la respuesta de `POST /residuos` | Pendiente |
| **TK-004-02** | Llamar a `calcular_alertas(db)` después del `db.commit()` en el POST | Pendiente |
| **TK-004-03** | Actualizar `ResiduoResponse` para incluir campo `alertas` opcional | Pendiente |
| **TK-004-04** | Verificar que los tests de Persona A siguen pasando tras el cambio | Pendiente |

---
